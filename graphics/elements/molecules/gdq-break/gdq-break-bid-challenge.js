import * as tslib_1 from "/bundles/gdqx18-layouts/node_modules/tslib/tslib.es6.js";
import { TimelineLite, TweenLite, Power2, Power4 } from "/bundles/gdqx18-layouts/node_modules/gsap/index.js";
import { createMaybeRandomTween } from "../../../../shared/lib/MaybeRandom.js";
const {
  customElement,
  property
} = Polymer.decorators;
/**
 * @customElement
 * @polymer
 */

let GdqBreakBidChallenge = class GdqBreakBidChallenge extends Polymer.Element {
  ready() {
    super.ready();
    const amountElem = this.$.amount;
    const percentElem = this.$.percent;
    amountElem.ease = Power2.easeOut;

    amountElem.displayValueTransform = displayValue => {
      return '$' + displayValue.toLocaleString('en-US', {
        maximumFractionDigits: 0,
        useGrouping: false
      });
    };

    percentElem.ease = Power2.easeOut;

    percentElem.displayValueTransform = displayValue => {
      return displayValue.toLocaleString('en-US', {
        maximumFractionDigits: 0,
        useGrouping: false
      }) + '%';
    };

    TweenLite.set(this, {
      opacity: 0
    });
    TweenLite.set(this.$.meter, {
      scaleX: 0
    });
    TweenLite.set(this.$['meter-line'], {
      scaleY: 0
    });
  }

  enter() {
    let meterPercent = this.bid.rawTotal / this.bid.rawGoal;
    meterPercent = Math.max(meterPercent, 0); // Clamp to min 0

    meterPercent = Math.min(meterPercent, 1); // Clamp to max 1

    if (Number.isNaN(meterPercent)) {
      meterPercent = 0;
    }

    const tl = new TimelineLite();
    const meterDuration = meterPercent * 0.75;
    tl.set(this.$.left, {
      width: `${meterPercent * 100}%`
    });
    tl.call(() => {
      this.$.goal.textContent = '$' + this.bid.rawGoal.toLocaleString('en-US', {
        maximumFractionDigits: 0,
        useGrouping: false
      });

      if (this.$.meter.clientWidth < this.$.amount.clientWidth) {
        TweenLite.set(this.$.amount, {
          right: '',
          left: '100%'
        });
      }
    }, undefined, null, '+=0.03');
    tl.add(createMaybeRandomTween({
      target: this.style,
      propName: 'opacity',
      duration: 0.465,
      ease: Power4.easeIn,
      start: {
        probability: 1,
        normalValue: 0
      },
      end: {
        probability: 0,
        normalValue: 1
      }
    }));
    tl.to(this.$['meter-line'], 0.324, {
      scaleY: 1,
      ease: Power2.easeInOut
    });
    tl.to(this.$.meter, meterDuration, {
      scaleX: 1,
      ease: Power2.easeOut,
      onStart: () => {
        this.$.amount.tween(this.bid.rawTotal, meterDuration);
        this.$.percent.tween(Math.floor(meterPercent * 100), meterDuration);
      }
    });
    return tl;
  }

  exit() {
    const tl = new TimelineLite();
    tl.add(createMaybeRandomTween({
      target: this.style,
      propName: 'opacity',
      duration: 0.2,
      ease: Power4.easeIn,
      start: {
        probability: 1,
        normalValue: 1
      },
      end: {
        probability: 0,
        normalValue: 0
      }
    }));
    return tl;
  }

};

tslib_1.__decorate([property({
  type: Object
})], GdqBreakBidChallenge.prototype, "bid", void 0);

GdqBreakBidChallenge = tslib_1.__decorate([customElement('gdq-break-bid-challenge')], GdqBreakBidChallenge);
export default GdqBreakBidChallenge;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdkcS1icmVhay1iaWQtY2hhbGxlbmdlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxTQUFRLFlBQVIsRUFBc0IsU0FBdEIsRUFBaUMsTUFBakMsRUFBeUMsTUFBekMsUUFBc0Qsb0RBQXREO0FBRUEsU0FBUSxzQkFBUixRQUFxQyx1Q0FBckM7QUFJQSxNQUFNO0FBQUMsRUFBQSxhQUFEO0FBQWdCLEVBQUE7QUFBaEIsSUFBNEIsT0FBTyxDQUFDLFVBQTFDO0FBRUE7Ozs7O0FBS0EsSUFBcUIsb0JBQW9CLEdBQXpDLE1BQXFCLG9CQUFyQixTQUFrRCxPQUFPLENBQUMsT0FBMUQsQ0FBaUU7QUFJaEUsRUFBQSxLQUFLLEdBQUE7QUFDSixVQUFNLEtBQU47QUFDQSxVQUFNLFVBQVUsR0FBRyxLQUFLLENBQUwsQ0FBTyxNQUExQjtBQUNBLFVBQU0sV0FBVyxHQUFHLEtBQUssQ0FBTCxDQUFPLE9BQTNCO0FBRUEsSUFBQSxVQUFVLENBQUMsSUFBWCxHQUFrQixNQUFNLENBQUMsT0FBekI7O0FBQ0EsSUFBQSxVQUFVLENBQUMscUJBQVgsR0FBb0MsWUFBRCxJQUF5QjtBQUMzRCxhQUFPLE1BQU0sWUFBWSxDQUFDLGNBQWIsQ0FBNEIsT0FBNUIsRUFBcUM7QUFDakQsUUFBQSxxQkFBcUIsRUFBRSxDQUQwQjtBQUVqRCxRQUFBLFdBQVcsRUFBRTtBQUZvQyxPQUFyQyxDQUFiO0FBSUEsS0FMRDs7QUFPQSxJQUFBLFdBQVcsQ0FBQyxJQUFaLEdBQW1CLE1BQU0sQ0FBQyxPQUExQjs7QUFDQSxJQUFBLFdBQVcsQ0FBQyxxQkFBWixHQUFxQyxZQUFELElBQXlCO0FBQzVELGFBQU8sWUFBWSxDQUFDLGNBQWIsQ0FBNEIsT0FBNUIsRUFBcUM7QUFDM0MsUUFBQSxxQkFBcUIsRUFBRSxDQURvQjtBQUUzQyxRQUFBLFdBQVcsRUFBRTtBQUY4QixPQUFyQyxJQUdGLEdBSEw7QUFJQSxLQUxEOztBQU9BLElBQUEsU0FBUyxDQUFDLEdBQVYsQ0FBYyxJQUFkLEVB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